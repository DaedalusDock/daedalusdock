<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/c4_file/terminal_program/operating_system/rtos/pincode_door - Daedalus Dock</title></head><body><header><a href="index.html">Daedalus Dock</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var">Var Details</a> - <a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#proc">Proc Details</a></header><main><h1>pincode_door <aside>/<a href="datum.html">datum</a>/<a href="datum/c4_file.html">c4_file</a>/<a href="datum/c4_file/terminal_program.html">terminal_program</a>/<a href="datum/c4_file/terminal_program/operating_system.html">operating_system</a>/<a href="datum/c4_file/terminal_program/operating_system/rtos.html">rtos</a>/<a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html">pincode_door</a></aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L19"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 19"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/airlock_bolt_state">airlock_bolt_state</a></th><td>Current airlock bolt state from update packets. If it's mismatched, we correct our state.</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/airlock_state">airlock_state</a></th><td>Current airlock state from update packets. If it's mismatched, we correct our state.</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/allow_lock_open">allow_lock_open</a></th><td>Is this door allowed to be held open (Press * while unlocked)</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/command_time">command_time</a></th><td>Timestamp for 4-second grace period.</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/control_mode">control_mode</a></th><td>Control Mode</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/correct_pin">correct_pin</a></th><td>Pin to compare to, if null, we need to collect one.</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/current_state">current_state</a></th><td>Current state machine state</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/door_state_timeout">door_state_timeout</a></th><td>Get our initial airlock state within 10 seconds.</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/door_timer">door_timer</a></th><td>Door autoclose timer</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/dwell_time">dwell_time</a></th><td>Airlock open duration</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/expected_airlock_state">expected_airlock_state</a></th><td>Expected airlock state</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/expected_bolt_state">expected_bolt_state</a></th><td>Expected bolt state</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/fault_string">fault_string</a></th><td>Recoverable fault string</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/pin_buffer">pin_buffer</a></th><td>Pin buffer</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/pin_length">pin_length</a></th><td>Pin length</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/tag_request_exit">tag_request_exit</a></th><td>Request-Exit Button ID</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/tag_slave">tag_slave</a></th><td>Slaved pad ID</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#var/tag_target">tag_target</a></th><td>Target airlock ID</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#proc/control_airlock">control_airlock</a></th><td>Send airlock control packet. Also updates expected states.</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#proc/doorstop">doorstop</a></th><td>(if allowed) stop the timer and hold the door open.</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#proc/draw_pin_dots">draw_pin_dots</a></th><td>Draws the pin position indicators, Cut out for cleanliness so it can be called in std_in().</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#proc/fast_update_doortimer">fast_update_doortimer</a></th><td>Calculate the door open header, Cut out so it can safely be placed in tick()</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#proc/fault">fault</a></th><td>Soft-Halt</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#proc/pin_accepted">pin_accepted</a></th><td>Fired on accepting a pin, If we have a dwell time, start the timer.
<code>skip_action</code> - Skip action, just restart the timer.</td></tr><tr><th><a href="datum/c4_file/terminal_program/operating_system/rtos/pincode_door.html#proc/timer_expire">timer_expire</a></th><td>Fired upon the expiration (or manual triggering therein) of the door timer.
This never gets called if the dwell time is zero.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/airlock_bolt_state"><aside class="declaration">var </aside>airlock_bolt_state <aside>– /tmp</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L45"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 45"></a></h3><p>Current airlock bolt state from update packets. If it's mismatched, we correct our state.</p><h3 id="var/airlock_state"><aside class="declaration">var </aside>airlock_state <aside>– /tmp</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L43"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 43"></a></h3><p>Current airlock state from update packets. If it's mismatched, we correct our state.</p><h3 id="var/allow_lock_open"><aside class="declaration">var </aside>allow_lock_open <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L29"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 29"></a></h3><p>Is this door allowed to be held open (Press * while unlocked)</p><h3 id="var/command_time"><aside class="declaration">var </aside>command_time <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L50"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 50"></a></h3><p>Timestamp for 4-second grace period.</p><h3 id="var/control_mode"><aside class="declaration">var </aside>control_mode <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L37"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 37"></a></h3><p>Control Mode</p><h3 id="var/correct_pin"><aside class="declaration">var </aside>correct_pin <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L31"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 31"></a></h3><p>Pin to compare to, if null, we need to collect one.</p><h3 id="var/current_state"><aside class="declaration">var </aside>current_state <aside>– /tmp</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L40"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 40"></a></h3><p>Current state machine state</p><h3 id="var/door_state_timeout"><aside class="declaration">var </aside>door_state_timeout <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L53"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 53"></a></h3><p>Get our initial airlock state within 10 seconds.</p><h3 id="var/door_timer"><aside class="declaration">var </aside>door_timer <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L48"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 48"></a></h3><p>Door autoclose timer</p><h3 id="var/dwell_time"><aside class="declaration">var </aside>dwell_time <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L27"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 27"></a></h3><p>Airlock open duration</p><h3 id="var/expected_airlock_state"><aside class="declaration">var </aside>expected_airlock_state <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L59"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 59"></a></h3><p>Expected airlock state</p><h3 id="var/expected_bolt_state"><aside class="declaration">var </aside>expected_bolt_state <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L61"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 61"></a></h3><p>Expected bolt state</p><h3 id="var/fault_string"><aside class="declaration">var </aside>fault_string <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L56"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 56"></a></h3><p>Recoverable fault string</p><h3 id="var/pin_buffer"><aside class="declaration">var </aside>pin_buffer <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L33"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 33"></a></h3><p>Pin buffer</p><h3 id="var/pin_length"><aside class="declaration">var </aside>pin_length <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L35"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 35"></a></h3><p>Pin length</p><h3 id="var/tag_request_exit"><aside class="declaration">var </aside>tag_request_exit <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L25"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 25"></a></h3><p>Request-Exit Button ID</p><h3 id="var/tag_slave"><aside class="declaration">var </aside>tag_slave <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L64"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 64"></a></h3><p>Slaved pad ID</p><h3 id="var/tag_target"><aside class="declaration">var </aside>tag_target <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L23"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 23"></a></h3><p>Target airlock ID</p><h2 id="proc">Proc Details</h2><h3 id="proc/control_airlock"><aside class="declaration">proc </aside>control_airlock<aside>(airlock_command)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L428"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 428"></a></aside></h3><p>Send airlock control packet. Also updates expected states.</p><h3 id="proc/doorstop"><aside class="declaration">proc </aside>doorstop<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L358"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 358"></a></aside></h3><p>(if allowed) stop the timer and hold the door open.</p><h3 id="proc/draw_pin_dots"><aside class="declaration">proc </aside>draw_pin_dots<aside>(redraw)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L234"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 234"></a></aside></h3><p>Draws the pin position indicators, Cut out for cleanliness so it can be called in std_in().</p><h3 id="proc/fast_update_doortimer"><aside class="declaration">proc </aside>fast_update_doortimer<aside>(redraw)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L253"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 253"></a></aside></h3><p>Calculate the door open header, Cut out so it can safely be placed in tick()</p><h3 id="proc/fault"><aside class="declaration">proc </aside>fault<aside>(error_text)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L135"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 135"></a></aside></h3><p>Soft-Halt</p><h3 id="proc/pin_accepted"><aside class="declaration">proc </aside>pin_accepted<aside>(skip_action)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L319"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 319"></a></aside></h3><p>Fired on accepting a pin, If we have a dwell time, start the timer.
<code>skip_action</code> - Skip action, just restart the timer.</p><h3 id="proc/timer_expire"><aside class="declaration">proc </aside>timer_expire<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/modules/computer4/data/terminal/rtos/pincode_door.dm#L341"><img src="git.png" width="16" height="16" title="code/modules/computer4/data/terminal/rtos/pincode_door.dm 341"></a></aside></h3><p>Fired upon the expiration (or manual triggering therein) of the door timer.
This never gets called if the dwell time is zero.</p></main><footer>daedalus.dme <a href="https://github.com/DaedalusDock/daedalusdock/tree/a11ad7c401daeb2805315aa8820f21ea7c1bf233">a11ad7c</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>