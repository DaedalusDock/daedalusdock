<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/obj/machinery/chem_master - Daedalus Dock</title></head><body><header><a href="index.html">Daedalus Dock</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="obj/machinery/chem_master.html#var">Var Details</a> - <a href="obj/machinery/chem_master.html#proc">Proc Details</a></header><main><h1>chem_master <aside>/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/chem_master.html">chem_master</a></aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L7"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 7"></a></h1><p>Machine that allows to identify and separate reagents in fitting container
as well as to create new containers with separated reagents in it.</p>
<p>Contains logic for both ChemMaster and CondiMaster, switched by &quot;condi&quot;.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="obj/machinery/chem_master.html#var/analyze_vars">analyze_vars</a></th><td>Info to display on 'analyze' screen</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/beaker">beaker</a></th><td>Input reagents container</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/bottle">bottle</a></th><td>Pill bottle for newly created pills</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/chosen_condi_style">chosen_condi_style</a></th><td>Currently selected condiment bottle style</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/chosen_pill_style">chosen_pill_style</a></th><td>Currently selected pill style</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/condi">condi</a></th><td>Decides what UI to show. If TRUE shows UI of CondiMaster, if FALSE - ChemMaster</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/condi_styles">condi_styles</a></th><td>List of available condibottle styles for UI</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/mode">mode</a></th><td>Whether separated reagents should be moved back to container or destroyed. 1 - move, 0 - destroy</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/patch_style">patch_style</a></th><td>Currently selected patch style</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/patch_styles">patch_styles</a></th><td>List of available patch styles for UI</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/pill_styles">pill_styles</a></th><td>List of available pill styles for UI</td></tr><tr><th><a href="obj/machinery/chem_master.html#var/screen">screen</a></th><td>Current UI screen. On the moment of writing this comment there were two: 'home' - main screen, and 'analyze' - info about specific reagent</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="obj/machinery/chem_master.html#proc/apply_condi_style">apply_condi_style</a></th><td>Applies style to condiment bottle.</td></tr><tr><th><a href="obj/machinery/chem_master.html#proc/get_condi_styles">get_condi_styles</a></th><td>Defines and provides list of available condiment bottle styles</td></tr><tr><th><a href="obj/machinery/chem_master.html#proc/guess_condi_style">guess_condi_style</a></th><td>Provides condiment bottle style based on reagents.</td></tr><tr><th><a href="obj/machinery/chem_master.html#proc/replace_beaker">replace_beaker</a></th><td>Handles process of moving input reagents containers in/from machine</td></tr><tr><th><a href="obj/machinery/chem_master.html#proc/strip_condi_styles_to_icons">strip_condi_styles_to_icons</a></th><td>Translates styles data into UI compatible format</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/analyze_vars"><aside class="declaration">var </aside>analyze_vars <aside>– /list</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L34"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 34"></a></h3><p>Info to display on 'analyze' screen</p><h3 id="var/beaker"><aside class="declaration">var </aside>beaker <aside>– /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/reagent_containers.html">reagent_containers</a></aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L20"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 20"></a></h3><p>Input reagents container</p><h3 id="var/bottle"><aside class="declaration">var </aside>bottle <aside>– /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/storage.html">storage</a>/pill_bottle</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L22"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 22"></a></h3><p>Pill bottle for newly created pills</p><h3 id="var/chosen_condi_style"><aside class="declaration">var </aside>chosen_condi_style <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L30"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 30"></a></h3><p>Currently selected condiment bottle style</p><h3 id="var/chosen_pill_style"><aside class="declaration">var </aside>chosen_pill_style <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L28"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 28"></a></h3><p>Currently selected pill style</p><h3 id="var/condi"><aside class="declaration">var </aside>condi <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L26"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 26"></a></h3><p>Decides what UI to show. If TRUE shows UI of CondiMaster, if FALSE - ChemMaster</p><h3 id="var/condi_styles"><aside class="declaration">var </aside>condi_styles <aside>– /list</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L38"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 38"></a></h3><p>List of available condibottle styles for UI</p><h3 id="var/mode"><aside class="declaration">var </aside>mode <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L24"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 24"></a></h3><p>Whether separated reagents should be moved back to container or destroyed. 1 - move, 0 - destroy</p><h3 id="var/patch_style"><aside class="declaration">var </aside>patch_style <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L40"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 40"></a></h3><p>Currently selected patch style</p><h3 id="var/patch_styles"><aside class="declaration">var </aside>patch_styles <aside>– /list</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L42"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 42"></a></h3><p>List of available patch styles for UI</p><h3 id="var/pill_styles"><aside class="declaration">var </aside>pill_styles <aside>– /list</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L36"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 36"></a></h3><p>List of available pill styles for UI</p><h3 id="var/screen"><aside class="declaration">var </aside>screen <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L32"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 32"></a></h3><p>Current UI screen. On the moment of writing this comment there were two: 'home' - main screen, and 'analyze' - info about specific reagent</p><h2 id="proc">Proc Details</h2><h3 id="proc/apply_condi_style"><aside class="declaration">proc </aside>apply_condi_style<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/reagent_containers.html">reagent_containers</a>/<a href="obj/item/reagent_containers/condiment.html">condiment</a>/container, /list/style)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L612"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 612"></a></aside></h3><p>Applies style to condiment bottle.</p>
<p>Applies props provided in &quot;style&quot; assuming that &quot;container&quot; is freshly created with no styles applied before.
User specified name for bottle applied after this method during bottle creation,
so container.name overwritten here for consistency rather than with some purpose in mind.</p>
<p>Arguments:</p>
<ul>
<li>container - condiment bottle that gets style applied to it</li>
<li>style - assoc list, must probably one from <a href="obj/machinery/chem_master.html#proc/get_condi_styles" title="/obj/machinery/chem_master">/obj/machinery/chem_master/proc/get_condi_styles</a></li>
</ul><h3 id="proc/get_condi_styles"><aside class="declaration">proc </aside>get_condi_styles<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L548"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 548"></a></aside></h3><p>Defines and provides list of available condiment bottle styles</p>
<p>Uses typelist() for styles storage after initialization.
For fallback style must provide style with key (const) CONDIMASTER_STYLE_FALLBACK
Returns list(
<key> = list(
&quot;icon_state&quot; = <bottle icon_state>,
&quot;name&quot; = <bottle name>,
&quot;desc&quot; = <bottle desc>,
?&quot;generate_name&quot; = &lt;if truthy, autogenerates default name from reagents instead of using &quot;name&quot;&gt;,
?&quot;icon_empty&quot; = &lt;icon_state when empty&gt;,
?&quot;fill_icon_thresholds&quot; = &lt;list of thresholds for reagentfillings, no tresholds if not provided or falsy&gt;,
?&quot;inhand_icon_state&quot; = &lt;inhand icon_state, falsy - no icon, not provided - whatever is initial (currently &quot;beer&quot;)&gt;,
?&quot;lefthand_file&quot; = &lt;file for inhand icon for left hand, ignored if &quot;inhand_icon_state&quot; not provided&gt;,
?&quot;righthand_file&quot; = &lt;same as &quot;lefthand_file&quot; but for right hand&gt;,
),
..
)</p><h3 id="proc/guess_condi_style"><aside class="declaration">proc </aside>guess_condi_style<aside>(/<a href="datum.html">datum</a>/<a href="datum/reagents.html">reagents</a>/reagents)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L590"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 590"></a></aside></h3><p>Provides condiment bottle style based on reagents.</p>
<p>Gets style from available by key, using last part of main reagent type (eg. &quot;rice&quot; for /datum/reagent/consumable/rice) as key.
If not available returns fallback style, or null if no such thing.
Returns list that is one of condibottle styles from <a href="obj/machinery/chem_master.html#proc/get_condi_styles" title="/obj/machinery/chem_master">/obj/machinery/chem_master/proc/get_condi_styles</a></p><h3 id="proc/replace_beaker"><aside class="declaration">proc </aside>replace_beaker<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/reagent_containers.html">reagent_containers</a>/new_beaker)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L168"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 168"></a></aside></h3><p>Handles process of moving input reagents containers in/from machine</p>
<p>When called checks for previously inserted beaker and gives it to user.
Then, if new_beaker provided, places it into src.beaker.
Returns <code>boolean</code>. TRUE if user provided (ignoring whether threre was any beaker change) and FALSE if not.</p>
<p>Arguments:</p>
<ul>
<li>user - Mob that initialized replacement, gets previously inserted beaker if there's any</li>
<li>new_beaker - New beaker to insert. Optional</li>
</ul><h3 id="proc/strip_condi_styles_to_icons"><aside class="declaration">proc </aside>strip_condi_styles_to_icons<aside>(/list/styles)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608/code/modules/reagents/chemistry/machinery/chem_master.dm#L514"><img src="git.png" width="16" height="16" title="code/modules/reagents/chemistry/machinery/chem_master.dm 514"></a></aside></h3><p>Translates styles data into UI compatible format</p>
<p>Expects to receive list of availables condiment styles in its complete format, and transforms them in simplified form with enough data to get UI going.
Returns list(list(&quot;id&quot; = <key>, &quot;className&quot; = <icon class>, &quot;title&quot; = <name and desc>),..).</p>
<p>Arguments:</p>
<ul>
<li>styles - List of styles for condiment bottles in internal format: <a href="obj/machinery/chem_master.html#proc/get_condi_styles" title="/obj/machinery/chem_master">/obj/machinery/chem_master/proc/get_condi_styles</a></li>
</ul></main><footer>daedalus.dme <a href="https://github.com/DaedalusDock/daedalusdock/tree/5ab5b0f18ffcc40cf3a31f75d1e3f6bac0eb7608">5ab5b0f</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>