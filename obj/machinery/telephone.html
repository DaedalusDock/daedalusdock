<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/obj/machinery/telephone - Daedalus Dock</title></head><body><header><a href="index.html">Daedalus Dock</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="obj/machinery/telephone.html#var">Var Details</a> - <a href="obj/machinery/telephone.html#proc">Proc Details</a></header><main><h1>telephone <aside>/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/telephone.html">telephone</a></aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L33"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 33"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="obj/machinery/telephone.html#var/active_caller">active_caller</a></th><td>list(netaddr,friendly_name) of active call</td></tr><tr><th><a href="obj/machinery/telephone.html#var/discovered_phones">discovered_phones</a></th><td>friendly_name:netid</td></tr><tr><th><a href="obj/machinery/telephone.html#var/friendly_name">friendly_name</a></th><td>The 'common name' of the station. Used in the UI.</td></tr><tr><th><a href="obj/machinery/telephone.html#var/placard_name">placard_name</a></th><td>Name 'placard', such as 'Special Hotline', gets appended to the end.</td></tr><tr><th><a href="obj/machinery/telephone.html#var/show_netids">show_netids</a></th><td>Do we show netaddrs in the phone UI, or just the names?</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="obj/machinery/telephone.html#proc/accept_call">accept_call</a></th><td>Accept the incoming call, Inform Originator.
STATE_ANSWER -&gt; STATE_CONNECTED</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/call_connected">call_connected</a></th><td>Acknowledge accepted call
STATE_ORIGINATE -&gt; STATE_CONNECTED</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/call_dropped">call_dropped</a></th><td>Far side dropped us, Perform hangup stuff and wait until the handset is returned to fully reset and be ready to accept another call
STATE_CONNECTED -&gt; STATE_HANGUP</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/cleanup_residual_call">cleanup_residual_call</a></th><td>We are listening to the buzzer telling us to hang up.
STATE_FARBUSY/STATE_HANGUP -&gt; STATE_WAITING</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/drop_call">drop_call</a></th><td>End call immediately
STATE_CONNECTED(handset onhook)/STATE_ORIGINATE(handset onhook)/STATE_ANSWER(packet) -&gt; STATE_WAITING</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/fuck_off_im_busy">fuck_off_im_busy</a></th><td>Remote phone can't answer due to busy, do the sound and wait until the handset is returned to reset.
STATE_ORIGINATE -&gt; STATE_FARBUSY</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/get_state_render">get_state_render</a></th><td>UI</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/handset_statechange">handset_statechange</a></th><td>Process the fact that the handset has changed states.</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/place_call">place_call</a></th><td>Register a new call
STATE_WAITING -&gt; STATE_ORIGINATE</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/recalculate_name">recalculate_name</a></th><td>Recalculate our name.</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/receive_call">receive_call</a></th><td>Receive the incoming call
STATE_WAITING -&gt; STATE_ANSWER</td></tr><tr><th><a href="obj/machinery/telephone.html#proc/toggle_handset">toggle_handset</a></th><td>Toggle the state of the handset.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/active_caller"><aside class="declaration">var </aside>active_caller <aside>– /list</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L51"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 51"></a></h3><p>list(netaddr,friendly_name) of active call</p><h3 id="var/discovered_phones"><aside class="declaration">var </aside>discovered_phones <aside>– /list</aside> <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L42"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 42"></a></h3><p>friendly_name:netid</p><h3 id="var/friendly_name"><aside class="declaration">var </aside>friendly_name <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L44"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 44"></a></h3><p>The 'common name' of the station. Used in the UI.</p><h3 id="var/placard_name"><aside class="declaration">var </aside>placard_name <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L46"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 46"></a></h3><p>Name 'placard', such as 'Special Hotline', gets appended to the end.</p><h3 id="var/show_netids"><aside class="declaration">var </aside>show_netids <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L48"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 48"></a></h3><p>Do we show netaddrs in the phone UI, or just the names?</p><h2 id="proc">Proc Details</h2><h3 id="proc/accept_call"><aside class="declaration">proc </aside>accept_call<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L296"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 296"></a></aside></h3><p>Accept the incoming call, Inform Originator.
STATE_ANSWER -&gt; STATE_CONNECTED</p><h3 id="proc/call_connected"><aside class="declaration">proc </aside>call_connected<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L307"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 307"></a></aside></h3><p>Acknowledge accepted call
STATE_ORIGINATE -&gt; STATE_CONNECTED</p><h3 id="proc/call_dropped"><aside class="declaration">proc </aside>call_dropped<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L333"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 333"></a></aside></h3><p>Far side dropped us, Perform hangup stuff and wait until the handset is returned to fully reset and be ready to accept another call
STATE_CONNECTED -&gt; STATE_HANGUP</p><h3 id="proc/cleanup_residual_call"><aside class="declaration">proc </aside>cleanup_residual_call<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L357"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 357"></a></aside></h3><p>We are listening to the buzzer telling us to hang up.
STATE_FARBUSY/STATE_HANGUP -&gt; STATE_WAITING</p><h3 id="proc/drop_call"><aside class="declaration">proc </aside>drop_call<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L317"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 317"></a></aside></h3><p>End call immediately
STATE_CONNECTED(handset onhook)/STATE_ORIGINATE(handset onhook)/STATE_ANSWER(packet) -&gt; STATE_WAITING</p><h3 id="proc/fuck_off_im_busy"><aside class="declaration">proc </aside>fuck_off_im_busy<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L345"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 345"></a></aside></h3><p>Remote phone can't answer due to busy, do the sound and wait until the handset is returned to reset.
STATE_ORIGINATE -&gt; STATE_FARBUSY</p><h3 id="proc/get_state_render"><aside class="declaration">proc </aside>get_state_render<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L368"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 368"></a></aside></h3><p>UI</p><h3 id="proc/handset_statechange"><aside class="declaration">proc </aside>handset_statechange<aside>(newstate)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L148"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 148"></a></aside></h3><p>Process the fact that the handset has changed states.</p><h3 id="proc/place_call"><aside class="declaration">proc </aside>place_call<aside>(target_phone)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L275"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 275"></a></aside></h3><p>Register a new call
STATE_WAITING -&gt; STATE_ORIGINATE</p><h3 id="proc/recalculate_name"><aside class="declaration">proc </aside>recalculate_name<aside>()  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L82"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 82"></a></aside></h3><p>Recalculate our name.</p><h3 id="proc/receive_call"><aside class="declaration">proc </aside>receive_call<aside>(/list/incoming_call)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L286"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 286"></a></aside></h3><p>Receive the incoming call
STATE_WAITING -&gt; STATE_ANSWER</p><h3 id="proc/toggle_handset"><aside class="declaration">proc </aside>toggle_handset<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/DaedalusDock/daedalusdock/blob/a11ad7c401daeb2805315aa8820f21ea7c1bf233/code/game/machinery/datanet/p2p_phones/_p2p_phones.dm#L122"><img src="git.png" width="16" height="16" title="code/game/machinery/datanet/p2p_phones/_p2p_phones.dm 122"></a></aside></h3><p>Toggle the state of the handset.</p></main><footer>daedalus.dme <a href="https://github.com/DaedalusDock/daedalusdock/tree/a11ad7c401daeb2805315aa8820f21ea7c1bf233">a11ad7c</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>